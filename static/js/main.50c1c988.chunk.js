(this["webpackJsonparoon-trivia-ui"]=this["webpackJsonparoon-trivia-ui"]||[]).push([[0],{178:function(e,t,a){e.exports=a(378)},183:function(e,t,a){},184:function(e,t,a){e.exports=a.p+"static/media/logo.ee7cd8ed.svg"},185:function(e,t,a){},312:function(e,t){},378:function(e,t,a){"use strict";a.r(t);var n=a(0),s=a.n(n),r=a(25),o=a.n(r),i=(a(183),a(51)),c=a(52),l=a(30),u=a(56),m=a(55),p=(a(184),a(185),a(48)),h=a.n(p),d=a(66),f=a(383),y=a(385),g=a(62),b="https://aroon-trivia.azurewebsites.net",w="".concat(b,"/answer"),v="".concat(b,"/join"),E="".concat(b,"/question"),S="".concat(b);function j(e){return e?"Connected":"\u274c Disconnected"}var q=function(e){Object(u.a)(a,e);var t=Object(m.a)(a);function a(e){var n;return Object(i.a)(this,a),(n=t.call(this,e)).state={waiting:!1},n.joinGame=n.joinGame.bind(Object(l.a)(n)),n.createGame=n.createGame.bind(Object(l.a)(n)),n}return Object(c.a)(a,[{key:"joinGame",value:function(){var e=Object(d.a)(h.a.mark((function e(t){var a;return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,this.setState({waiting:!0}),t.room=t.room.trim().toUpperCase(),t.name=t.name.trim(),e.next=6,fetch(v,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)});case 6:200!==(a=e.sent).status?alert("Unable to join game. Error message: ".concat(a.status," Response")):this.props.joinGame(t),e.next=13;break;case 10:e.prev=10,e.t0=e.catch(0),alert("Unable to join game. Error message: ".concat(e.t0));case 13:return e.prev=13,this.setState({waiting:!1}),e.finish(13);case 16:case"end":return e.stop()}}),e,this,[[0,10,13,16]])})));return function(t){return e.apply(this,arguments)}}()},{key:"createGame",value:function(){var e=Math.random().toString(36).substr(2,4).toUpperCase();this.props.createGame(e)}},{key:"render",value:function(){var e={wrapperCol:{offset:8,span:16}};return s.a.createElement("div",null,s.a.createElement("h1",null,"Aroon Trivia"),s.a.createElement(f.a,Object.assign({},{labelCol:{span:8},wrapperCol:{span:16}},{onFinish:this.joinGame}),s.a.createElement(f.a.Item,{name:"room",label:"Room Code",rules:[{required:!0}]},s.a.createElement(y.a,{size:"large"})),s.a.createElement(f.a.Item,{name:"name",label:"Your Name",rules:[{required:!0}]},s.a.createElement(y.a,{size:"large"})),s.a.createElement(f.a.Item,e,this.state.wait?s.a.createElement("i",null,"Joining room..."):s.a.createElement(g.a,{type:"primary",size:"large",htmlType:"submit"},"Join Game")),s.a.createElement(f.a.Item,e,s.a.createElement(g.a,{size:"large",onClick:this.createGame},"Create Game"))))}}]),a}(s.a.Component),k=a(387),O=a(382),C=a(98),T=a.n(C),A=function(e){Object(u.a)(a,e);var t=Object(m.a)(a);function a(e){var n;return Object(i.a)(this,a),(n=t.call(this,e)).state={question:"Waiting for a question...",questionStyle:"",acceptAnswers:!1,waiting:!1,connected:!1},n.submitAnswer=n.submitAnswer.bind(Object(l.a)(n)),n.answerForm=n.answerForm.bind(Object(l.a)(n)),n}return Object(c.a)(a,[{key:"componentDidMount",value:function(){var e=this,t=T()(S,{path:"/register",query:{room:this.props.room,name:this.props.name},transports:["websocket"]});t.on("connect",(function(){e.setState({connected:!0})})),t.on("disconnect",(function(){e.setState({connected:!1})})),t.on("question",(function(t){console.log(t),e.setState({question:t.question,questionStyle:t.questionStyle,acceptAnswers:!0})}))}},{key:"submitAnswer",value:function(){var e=Object(d.a)(h.a.mark((function e(t){var a;return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,this.setState({waiting:!0}),e.next=4,fetch(w,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({answer:t.answer,points:+t.points?+t.points:0,room:this.props.room,player:this.props.name})});case 4:200!==(a=e.sent).status?alert("Unable to submit answer. Error message: ".concat(a.status," Response")):this.setState({question:"Answer received! Waiting for another question...",acceptAnswers:!1}),e.next=11;break;case 8:e.prev=8,e.t0=e.catch(0),alert("Unable to submit answer. Error message: ".concat(e.t0));case 11:return e.prev=11,this.setState({waiting:!1}),e.finish(11);case 14:case"end":return e.stop()}}),e,this,[[0,8,11,14]])})));return function(t){return e.apply(this,arguments)}}()},{key:"answerForm",value:function(){var e={wrapperCol:{offset:8,span:16}};return s.a.createElement(f.a,Object.assign({},{labelCol:{span:8},wrapperCol:{span:16}},{onFinish:this.submitAnswer}),s.a.createElement(f.a.Item,{name:"answer",label:"Answer",rules:[{required:!0}]},s.a.createElement(y.a,{size:"large"})),"custom"!==this.state.questionStyle&&"pointPer"!==this.state.questionStyle?s.a.createElement(f.a.Item,{name:"points",label:"Points",rules:[{required:!0}]},s.a.createElement(k.a,{size:"large"})):null,s.a.createElement(f.a.Item,e,this.state.waiting?s.a.createElement("div",null,"Submitting answer..."):s.a.createElement(g.a,{type:"primary",size:"large",htmlType:"submit"},"Submit Answer")))}},{key:"render",value:function(){return s.a.createElement("div",null,s.a.createElement(O.a,{title:"Game ".concat(this.props.room),onBack:this.props.goBack,subTitle:j(this.state.connected)}),s.a.createElement("h3",null,"Question"),s.a.createElement("p",null,this.state.question),this.state.acceptAnswers?this.answerForm():null)}}]),a}(s.a.Component),P=a(120),G=a(386),N=a(384),x=a(388),I=a(381),L=a(82),z=function(e){Object(u.a)(a,e);var t=Object(m.a)(a);function a(e){var n;return Object(i.a)(this,a),(n=t.call(this,e)).state={players:[],answers:[],question:"",questionStyle:"",waiting:!1,asked:0,connected:!1},n.mapPlayersToList=n.mapPlayersToList.bind(Object(l.a)(n)),n.mapAnswersToList=n.mapAnswersToList.bind(Object(l.a)(n)),n.adjustScore=n.adjustScore.bind(Object(l.a)(n)),n.adjustPoints=n.adjustPoints.bind(Object(l.a)(n)),n.submitQuestion=n.submitQuestion.bind(Object(l.a)(n)),n.pointAdjusters=n.pointAdjusters.bind(Object(l.a)(n)),n.applyPoints=n.applyPoints.bind(Object(l.a)(n)),n.questionForm=n.questionForm.bind(Object(l.a)(n)),n.toggleCorrect=n.toggleCorrect.bind(Object(l.a)(n)),n.waitingText=n.waitingText.bind(Object(l.a)(n)),n}return Object(c.a)(a,[{key:"componentDidMount",value:function(){var e=this,t=T()(S,{path:"/register",query:{room:this.props.room+"-admin"},transports:["websocket"]});t.on("connect",(function(){e.setState({connected:!0})})),t.on("disconnect",(function(){e.setState({connected:!1})})),t.on("submission",(function(t){e.setState((function(a){if(!(a.answers.find((function(e){return e.player===t.player}))>-1))return"custom"===e.state.questionStyle?(t.points=0,t.correct=!0):"pointPer"===e.state.questionStyle?(t.points=1,t.correct=!1):t.correct=!1,{answers:[t].concat(Object(P.a)(a.answers))}}))})),t.on("join",(function(t){e.setState((function(e){if(!(e.players.find((function(e){return e.name===t}))>-1))return{players:[{name:t,score:0}].concat(Object(P.a)(e.players))}}))}))}},{key:"adjustScore",value:function(e,t){this.setState((function(a){var n=a.players.findIndex((function(t){return t.name===e})),s=JSON.parse(JSON.stringify(a.players));return s[n].score+=t,{players:s}}))}},{key:"adjustPoints",value:function(e,t){this.setState((function(a){var n=a.answers.findIndex((function(t){return t.player===e})),s=JSON.parse(JSON.stringify(a.answers));return s[n].points+=t,{answers:s}}))}},{key:"toggleCorrect",value:function(e){this.setState((function(t){var a=t.answers.findIndex((function(t){return t.player===e})),n=JSON.parse(JSON.stringify(t.answers));return n[a].correct=!n[a].correct,{answers:n}}))}},{key:"mapPlayersToList",value:function(e){var t=this;return e.sort((function(e,t){return e.score>t.score})).map((function(e){return s.a.createElement("li",{className:"list",key:e.name},s.a.createElement("strong",null,e.name),s.a.createElement("span",{className:"bump-left"},e.score),s.a.createElement(g.a,{size:"small",className:"big-bump-left",onClick:function(){return t.adjustScore(e.name,-1)}},"-"),s.a.createElement(g.a,{size:"small",onClick:function(){return t.adjustScore(e.name,1)}},"+"))}))}},{key:"mapAnswersToList",value:function(e){var t=this;return e.map((function(e){return s.a.createElement("li",{className:"list",key:e.player},s.a.createElement("h4",null,e.player),s.a.createElement("i",null,e.answer),"pointPer"!==t.state.questionStyle?s.a.createElement("strong",{className:"bump-left"},e.points):null,"custom"===t.state.questionStyle?t.pointAdjusters(e):null,"custom"!==t.state.questionStyle?s.a.createElement(G.a,{className:"big-bump-left",checked:e.correct,onChange:function(){return t.toggleCorrect(e.player)}},"Correct"):null)}))}},{key:"pointAdjusters",value:function(e){var t=this;return s.a.createElement("div",{className:"inline"},s.a.createElement(g.a,{size:"small",className:"big-bump-left",onClick:function(){return t.adjustPoints(e.player,-1)}},"-"),s.a.createElement(g.a,{size:"small",onClick:function(){return t.adjustPoints(e.player,1)}},"+"))}},{key:"applyPoints",value:function(){var e=this;this.state.answers.forEach((function(t){e.setState((function(e){var a=JSON.parse(JSON.stringify(e.players)),n=a.findIndex((function(e){return e.name===t.player}));return t.correct?("pointPer"===e.questionStyle?a[n].score+=1:a[n].score+=t.points,{players:a}):"wagerLoss"===e.questionStyle?(a[n].score-=t.points,{players:a}):void 0}))})),this.setState({answers:[],question:"",questionStyle:""})}},{key:"submitQuestion",value:function(){var e=Object(d.a)(h.a.mark((function e(t){var a,n;return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a=!0,this.state.answers.length>0&&(a=window.confirm("You haven't applied the points from the last question - are you sure you want to ask a new one?")),!a){e.next=17;break}return e.prev=3,this.setState({waiting:!0}),e.next=7,fetch(E,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({question:t.question,questionStyle:t.questionStyle,room:this.props.room})});case 7:200!==(n=e.sent).status?alert("Unable to submit question. Error message: ".concat(n.status," Response")):this.setState((function(e){return{asked:e.asked+1,question:t.question,questionStyle:t.questionStyle,answers:[]}})),e.next=14;break;case 11:e.prev=11,e.t0=e.catch(3),alert("Unable to submit question. Error message: ".concat(e.t0));case 14:return e.prev=14,this.setState({waiting:!1}),e.finish(14);case 17:case"end":return e.stop()}}),e,this,[[3,11,14,17]])})));return function(t){return e.apply(this,arguments)}}()},{key:"questionStyles",value:function(){return s.a.createElement("ul",null,s.a.createElement("li",null,s.a.createElement("strong",null,"Wager"),s.a.createElement("span",{className:"bump-left"},"The players choose how many points to wager on their question. If they get it right, those points are added to their score. If they get it wrong, there is no penalty.")),s.a.createElement("li",null,s.a.createElement("strong",null,"Wager with Loss"),s.a.createElement("span",{className:"bump-left"},"The players choose how many points to wager on their question. If they get it right, those points are added to their score. If they get it wrong, those points are subtracted from their score.")),s.a.createElement("li",null,s.a.createElement("strong",null,"Point-per-Question"),s.a.createElement("span",{className:"bump-left"},"The players get one point added to their scores if they get it right.")),s.a.createElement("li",null,s.a.createElement("strong",null,"Gamemaster Chooses"),s.a.createElement("span",{className:"bump-left"},"The Gamemaster chooses how many points to award each player for their answer. Great for open-ended questions!")))}},{key:"questionForm",value:function(){var e={wrapperCol:{offset:4,span:20}};return s.a.createElement(f.a,Object.assign({},{labelCol:{span:4},wrapperCol:{span:20}},{onFinish:this.submitQuestion}),s.a.createElement(f.a.Item,{name:"question",label:"Question",rules:[{required:!0}]},s.a.createElement(y.a.TextArea,null)),s.a.createElement(f.a.Item,{name:"questionStyle",label:"Question Style",rules:[{required:!0}]},s.a.createElement(N.a,{placeholder:"Select a question style..."},s.a.createElement(L.Option,{value:"wager"},"Wager"),s.a.createElement(L.Option,{value:"wagerLoss"},"Wager with Loss"),s.a.createElement(L.Option,{value:"pointPer"},"Point-per-Question"),s.a.createElement(L.Option,{value:"custom"},"Gamemaster Chooses"))),s.a.createElement(f.a.Item,e,this.state.waiting?s.a.createElement("div",null,"Submitting question..."):s.a.createElement(g.a,{type:"primary",size:"large",htmlType:"submit"},"Submit Question"),s.a.createElement(x.a,{title:"Question Styles",content:this.questionStyles(),trigger:"click"},s.a.createElement(g.a,{size:"large",className:"bump-left"},"Question Style Help"))))}},{key:"waitingText",value:function(){return""!==this.state.question?"Waiting for answers...":"Ask a question!"}},{key:"render",value:function(){return s.a.createElement("div",null,s.a.createElement(O.a,{title:"Game ".concat(this.props.room),onBack:this.props.goBack,subTitle:j(this.state.connected)}),s.a.createElement(I.a,{title:"Players",extra:"".concat(this.state.players.length)},s.a.createElement("ul",null,this.mapPlayersToList(this.state.players))),s.a.createElement(I.a,{title:"Answers",extra:"".concat(this.state.answers.length,"/").concat(this.state.players.length)},""!==this.state.question?s.a.createElement("p",null,s.a.createElement("strong",null,function(e){switch(e){case"wager":return"Wager";case"wagerLoss":return"Wager with Loss";case"pointPer":return"Point-per-Question";case"custom":return"Gamemaster Chooses";default:return""}}(this.state.questionStyle))," - ",this.state.question):null,s.a.createElement("ul",null,this.mapAnswersToList(this.state.answers)),this.state.answers.length>0?s.a.createElement(g.a,{size:"large",type:"primary",onClick:this.applyPoints},"Apply Points"):s.a.createElement("i",null,this.waitingText())),s.a.createElement(I.a,{title:"Question",extra:"".concat(this.state.asked," question").concat(1===this.state.asked?"":"s"," asked")},this.questionForm()))}}]),a}(s.a.Component),J=function(e){Object(u.a)(a,e);var t=Object(m.a)(a);function a(e){var n;return Object(i.a)(this,a),(n=t.call(this,e)).state={room:"",name:"",page:"login"},n.loadGame=n.loadGame.bind(Object(l.a)(n)),n.loadAdmin=n.loadAdmin.bind(Object(l.a)(n)),n.loadLogin=n.loadLogin.bind(Object(l.a)(n)),n}return Object(c.a)(a,[{key:"loadGame",value:function(e){this.setState({room:e.room,name:e.name,page:"game"})}},{key:"loadAdmin",value:function(e){this.setState({room:e,page:"admin"})}},{key:"loadLogin",value:function(){this.setState({page:"login"})}},{key:"render",value:function(){switch(this.state.page){case"admin":return s.a.createElement(z,{room:this.state.room,goBack:this.loadLogin});case"game":return s.a.createElement(A,{room:this.state.room,name:this.state.name,goBack:this.loadLogin});default:return s.a.createElement(q,{joinGame:this.loadGame,createGame:this.loadAdmin})}}}]),a}(s.a.Component);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));o.a.render(s.a.createElement(s.a.StrictMode,null,s.a.createElement(J,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))}},[[178,1,2]]]);
//# sourceMappingURL=main.50c1c988.chunk.js.map